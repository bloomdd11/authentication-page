<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>
    <%= header %>
  </title>
</head>

<body>
  <h1>Authentication Page</h1>
  <form method="post">
    Email: <input type="email" name="email" id="email" required>
    Password: <input type="password" name="password" id="password" required>
  </form>
  <button type="submit" id="submit">Login</button>
  <button id="viewUsers">View Users</button>


  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"
    integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ=="
    crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
  <script>
    const authUrl = 'http://localhost:3000/api/v1/auth'
    const jobUrl = 'http://localhost:3000/api/v1/job'

    $("#submit").click(async (e) => {
      let email = $("#email").val()
      let password = $("#password").val()
      try {
        const { data: { token, username } } = await axios.post(authUrl + '/login', { email, password })
        console.log("username : " + username);
        console.log("token : " + token);
      } catch (error) {
        const { response: { data } } = error
        console.log(data);
      }
    })

    const login = async (email, password) => {
      await axios.post(authUrl + '/login', { email, password })
        .then((res) => {
          return res
        })
    }

    let data = []
    const viewUser = async () => {
      axios.get(authUrl + '/view')
        .then((res) => {
          const { data: users } = res
          //console.log(users);
          data = [...users]
        })
        .catch(err => console.log(err))

    }

    $("#viewUsers").click(() => {
      viewUser()
      setTimeout(() => {
        console.log(data);
      }, 1000)
    })
  </script>
</body>

</html>